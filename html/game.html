<html>
  <style>
  h1 {
  	font-family: "Segoe UI", Frutiger, "Frutiger Linotype", "Dejavu Sans", "Helvetica Neue", Arial, sans-serif;
  	font-size: 49px;
  	font-style: normal;
  	font-variant: normal;
    color: white;
  	font-weight: 500;
  	line-height: 53.9px;
  }
  html {
    background: url("") no-repeat center center fixed;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
  }
  </style>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://bootswatch.com/cyborg/bootstrap.min.css" crossorigin="anonymous">
  <!-- Latest compiled and minified JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <body style="background-color: transparent;">
    <center>
      <br>
      <br>
      <h1 class="words">

      </h1>
      <h1 class="win">
      </h1>
      <h1 class="win2" style="display: none">
      </h1>
      <center class="sboard" style="display: none">
        <ul class="list-group leaderboard" style="width: 30em">
          <!--li class="list-group-item">
            Jay Williams - 39
          </li-->
        </ul>
      </center>
    </center>
  </body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.6.8/sweetalert2.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/6.6.8/sweetalert2.min.css">
  <script>
    var bases = {
      lemon: "url('lemons-base.jpg')",
      bannana: "url('bannana-base.jpg')",
      lime: "url('lime-base.jpg')",
      orange: "url('orange-base.jpg')"
    }
    var out = [];
    for (key in bases){
      if (!bases.hasOwnProperty(key)) continue;
      out.push(key)
    }
    function choose(choices) {
      var index = Math.floor(Math.random() * choices.length);
      return choices[index];
    }
    var mappings = {
      KeyA: "lemon",
      KeyW: "bannana",
      KeyS: "lime",
      KeyD: "orange"
    }
    var current = {};
    function initPic(pic, word) {
      $("html").css("background-image", pic);
      $(".words").text(word);
      current.pic = pic;
      current.word = word;
    }

    setTimeout(function () {
      // After xyz secs
      $("html").css("background-image", "");
      $("html").css("background-color", "black");
      $(".words").fadeOut()
      $(".win2").text("You scored " + rounds + " points.")
      $(".win2").fadeIn()
      $(".sboard").fadeIn()
      swal({
        title: 'What\'s your name?',
        input: 'text',
        showCancelButton: true,
        confirmButtonText: 'Submit',
        showLoaderOnConfirm: true,
        allowOutsideClick: false
      }).then(function (name) {
        $.ajax({
          url: '/add-score/',
          type: 'post',
          data: {
              access_token: 'XXXXXXXXXXXXXXXXXXX'
          },
          headers: {
              "XName": name,
              "XScore": rounds
          },
          dataType: 'json',
          success: function (data) {
              console.info(data);
              $.get("/get-score/", function (d) {
                var arr = JSON.parse(d);
                for (var i = 0; i < arr.length ; i++) {
                  $(".leaderboard").append("<li class='list-group-item'> " + arr[i].name + " - " + arr[i].score + " </li>")
                }
              })
          }
        });
      })
      document.onkeyup = function () {};
    }, 60000)

    var rounds = 0;
    initPic(bases[choose(out)], choose(out))

    document.onkeyup = function (e) {
      var mapped = mappings[e.code]
      if(mapped == undefined) return;
      if (mapped == current.word) {
        var key = choose(out)
        var key2 = choose(out)
        rounds++;
        initPic(bases[key2], key)
      }
      else {
      }


    }
  </script>
  </html>
